<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>When - Juego de Terror en Pixel Art</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            overflow: hidden;
            color: #e0e0e0;
            background-color: #e0f7fa; /* Color de fondo azul claro */
        }
        header {
            text-align: center;
            padding: 20px;
            position: relative;
            z-index: 10;
        }
        h1 {
            font-size: 3em;
            text-shadow: 2px 2px 0 #00796b; /* Sombra en un tono más oscuro de azul */
            font-family: 'Press Start 2P', cursive;
        }
        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background: rgba(30, 30, 30, 0.9); /* Fondo oscuro */
            border: 2px solid #00bcd4; /* Borde azul claro */
            border-radius: 10px;
            box-shadow: 0 0 10px #00bcd4; /* Sombra en un tono azul claro */
            position: relative;
            z-index: 10;
        }
        .story, .mechanics {
            font-size: 1.2em;
            line-height: 1.5;
            text-align: justify;
            margin-bottom: 20px;
        }
        footer {
            text-align: center;
            padding: 20px;
            background: rgba(30, 30, 30, 0.9); /* Fondo oscuro */
            border-top: 5px solid #00bcd4; /* Borde azul claro */
            position: relative;
            bottom: 0;
            width: 100%;
            z-index: 10;
        }
        .button {
            display: inline-block;
            padding: 10px 20px;
            margin: 20px 0;
            background-color: #00796b; /* Color de fondo azul oscuro */
            color: #fff;
            text-decoration: none;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        .button:hover {
            background-color: #004d40; /* Color de fondo azul más oscuro al pasar el ratón */
        }
        .screenshots {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        .screenshot {
            flex: 1;
            margin: 0 10px;
            border: 2px solid #00bcd4; /* Borde azul claro */
            border-radius: 5px;
            overflow: hidden;
        }
        .screenshot img {
            width: 100%;
            height: auto;
        }
        /* Parallax Background */
        .parallax {
            background-image: url('https://art.pixilart.com/sr23edaed22dcaws3.png'); /* Cambia esto por la URL de tu imagen de fondo */
            height: 100vh;
            background-attachment: fixed;
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
            position: relative;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <div class="parallax">
        <header>
            <h1>When</h1>
        </header>
        <div class="container">
            <h2>Historia</h2>
            <p class="story">
                Poco se sabe del comienzo de todo. Un día en las noticias salió sobre un experimento científico que falló y 7 días después llovió a cántaros por todas partes. No era una lluvia común, en vez de agua caían gotas luminosas de varios colores. A pesar de que los científicos aconsejaron evitar todo contacto con esta por ser peligrosa, muchas de las personas hicieron caso omiso. Y así es como el 30% de la humanidad contrajo la plaga roja. 1 día después el mundo estaba lleno de mutantes. Al día de hoy han pasado 6 meses desde que todo comenzó, no se sabe cuántas personas aún viven ahí fuera pero los pocos sobrevivientes que quedan en la faz de la tierra hacen lo mejor que pueden para evadir a los mutantes y a las lluvias arcoiris.
            </p>
            <h2>Mecánicas del Juego</h2>
            <p class="mechanics">
                - **Estrategia**: Usa tus recursos sabiamente para sobrevivir. <br>
                - **Sigilo**: Evita a los mutantes y las lluvias arcoiris para mantenerte con vida. <br>
                - **Supervivencia**: Encuentra comida y refugio mientras evitas el contacto con la plaga roja.
            </p>

            <h2>Capturas de Pantalla</h2>
            <div class="screenshots">
                <div class="screenshot">
                    <img src="screenshot1.png" alt="Captura de Pantalla 1">
                </div>
                <div class="screenshot">
                    <img src="screenshot2.png" alt="Captura de Pantalla 2">
                </div>
                <div class="screenshot">
                    <img src="screenshot3.png" alt="Captura de Pantalla 3">
                </div>
            </div>
        </div>
        <footer>
            <a href="#" class="button" id="reserveButton">Reservar</a>
            <p>Reservas: <span id="counter">0</span></p>
        </footer>
    </div>

    <script>
        const apiUrl = 'https://github.com/helsing22/Web-When-/blob/main/server.js'; // Cambia esto por la URL de tu API real

        // Obtener el total de reservas desde el backend
        async function fetchTotalReservations() {
            try {
                const response = await fetch(apiUrl);
                const data = await response.json();
                return data.totalReservations; // Asegúrate de que tu API devuelva un objeto con esta propiedad
            } catch (error) {
                console.error('Error al obtener el total de reservas:', error);
                return 0; // Retornar 0 en caso de error
            }
        }

        // Inicializar el contador desde el backend
        async function initializeCounter() {
            const totalReservations = await fetchTotalReservations();
            document.getElementById('counter').textContent = totalReservations;

            // Verificar si el usuario ya ha hecho una reserva
            const hasReserved = localStorage.getItem('hasReserved');

            // Si el usuario no ha reservado, agregar el evento de clic
            if (!hasReserved) {
                document.getElementById('reserveButton').addEventListener('click', async function(event) {
                    event.preventDefault(); // Evitar el comportamiento por defecto del enlace

                    // Actualizar el total de reservas en el backend
                    try {
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({ increment: 1 }) // Asegúrate de que tu API acepte este formato
                        });

                        if (response.ok) {
                            const updatedData = await response.json();
                            document.getElementById('counter').textContent = updatedData.totalReservations;
                            localStorage.setItem('hasReserved', 'true'); // Marcar que el usuario ha reservado
                        } else {
                            console.error('Error al realizar la reserva:', response.statusText);
                        }
                    } catch (error) {
                        console.error('Error al realizar la reserva:', error);
                    }
                });
            }
        }

        // Inicializar el contador al cargar la página
        window.onload = initializeCounter;
    </script>
</body>
</html>
